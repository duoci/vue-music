(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3daef7c"],{"15bf":function(t,e,s){"use strict";s("9354")},"1fa1":function(t,e,s){t.exports=s.p+"static/img/disc.a42bb8f4.png"},"4ffd":function(t,e,s){t.exports=s.p+"static/img/logo.47591c5c.png"},"5f35":function(t,e,s){t.exports=s.p+"static/img/test.b66d0610.jpg"},"612c":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hotComments"},[s("div",{staticClass:"commentHeader"},[t._t("title")],2),t._l(t.comments,(function(e,i){return s("div",{key:i,staticClass:"commentItem"},[s("div",{staticClass:"commentCreatorAvatar"},[s("img",{attrs:{src:e.user.avatarUrl+"?param=100y100",alt:""},on:{click:function(s){return t.goToPersonal(e.user.userId)}}})]),s("div",{staticClass:"commentMain"},[s("div",{staticClass:"commentContent"},[s("span",{staticClass:"commentUserNickName",on:{click:function(s){return t.goToPersonal(e.user.userId)}}},[t._v(t._s(e.user.nickname)+": ")]),s("span",[t._v(t._s(e.content))])]),s("div",{staticClass:"replied"},t._l(e.beReplied,(function(i,a){return s("div",{key:a,staticClass:"repliedItem"},[s("span",{staticClass:"repliedUser",on:{click:function(s){return t.goToPersonal(e.user.userId)}}},[t._v("@"+t._s(i.user.nickname)+": ")]),s("span",{staticClass:"repliedContent"},[t._v(t._s(i.content))])])})),0),s("div",{staticClass:"commentBottom"},[s("div",{staticClass:"commentCreatedTime"},[t._v(" "+t._s(t._f("showDate")(e.time))+" ")]),s("div",{staticClass:"commentButtons"},[s("div",{class:e.liked?"likeCurrentComment":"",on:{click:function(s){return t.likeCurrentComment(e.liked,e.commentId)}}},[s("i",{staticClass:"iconfont icon-good"}),t._v(" "+t._s(e.likedCount)+" ")]),t._m(0,!0),t._m(1,!0)])])])])}))],2)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("i",{staticClass:"iconfont icon-zhuanfa"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("i",{staticClass:"iconfont icon-pinglun"})])}],c=s("d930"),n=s("2f62"),r={name:"Comment",props:{comments:{type:Array,default(){return[]}},commentType:{type:String,default(){return""}},commentId:{type:String,default(){return""}},musicTitle:{type:String,default(){return""}},isHotComment:{type:Boolean,default(){return!0}}},methods:{...Object(n["b"])(["changeMusicDetailCardState"]),async likeCurrentComment(t,e){if(!this.$store.state.isLogin)return void this.$message.warning("只有登陆后才能点赞哦!");const s=Date.parse(new Date);let i;switch(this.commentType){case"album":i=3;break;case"musicList":i=2;break;case"music":i=0;break;case"mv":i=1;break;case"video":i=5;break}const a=await this.get("/comment/like",{id:this.commentId,cid:e,t:t?0:1,type:i,timestamp:s});200===a.code?this.$emit("getComment"):this.$message.error("点赞失败,请稍后重试!")},goToPersonal(t){this.$router.push({name:"personal",params:{uid:t}}),"music"===this.commentType&&this.changeMusicDetailCardState(!1)}},filters:{showDate(t){const e=new Date(t);return Object(c["a"])(e,"yyyy-MM-dd")}}},o=r,l=(s("15bf"),s("2877")),u=Object(l["a"])(o,i,a,!1,null,"65bbec1a",null);e["a"]=u.exports},"7e9b":function(t,e,s){t.exports=s.p+"static/img/erweima.46abf71b.png"},8391:function(t,e,s){},"914c":function(t,e,s){"use strict";s("8391")},9354:function(t,e,s){},"93fd":function(t,e,s){"use strict";s("b925")},"9f74":function(t,e,s){"use strict";s("a16a")},a16a:function(t,e,s){},a60e:function(t,e,s){"use strict";s("e6ad")},b925:function(t,e,s){},baf1:function(t,e,s){t.exports=s.p+"static/img/needle.72039ea9.png"},c7bd:function(t,e,s){"use strict";s("d74b")},d504:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",[s("el-header",[s("header-bar")],1),s("el-container",[s("el-aside",{attrs:{width:"200px"}},[s("el-menu",{attrs:{"active-text-color":"black",router:"","default-active":t.defaultActive}},[t._l(t.elmenuitemData,(function(e,i){return s("el-menu-item",{key:i,attrs:{index:e.router}},[s("i",{class:e.class}),s("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title))])])})),0!=t.createdMusicList.length?s("el-menu-item-group",[s("template",{staticClass:"groupTitle",slot:"title"},[t._v("创建的歌单")]),t._l(t.createdMusicList,(function(e,i){return s("el-menu-item",{key:i,attrs:{index:"/musiclistdetail/"+e.id}},[s("i",{staticClass:"iconfont icon-gedan"}),t._v(t._s(e.name))])}))],2):t._e(),0!=t.collectMusicList.length?s("el-menu-item-group",[s("template",{staticClass:"groupTitle",slot:"title"},[t._v("收藏的歌单")]),t._l(t.collectMusicList,(function(e,i){return s("el-menu-item",{key:i,attrs:{index:"/musiclistdetail/"+e.id}},[s("i",{staticClass:"iconfont icon-gedan"}),t._v(t._s(e.name))])}))],2):t._e()],2)],1),s("el-main",[s("router-view",{key:t.$route.fullPath,staticClass:"routerView"})],1)],1),s("bottom-control"),s("music-detail-card",{staticClass:"musicDetailCard"})],1)},a=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"headerBar"},[t._m(0),i("div",{staticClass:"center"},[i("div",{staticClass:"buttons"},[i("i",{staticClass:"iconfont icon-arrow-left-bold back",on:{click:function(e){return t.$router.go(-1)}}}),i("i",{staticClass:"iconfont icon-arrow-right-bold forward",on:{click:function(e){return t.$router.go(1)}}})]),i("div",{staticClass:"search"},[i("el-popover",{attrs:{placement:"bottom",width:"300","popper-class":"searchPop",trigger:"focus"},model:{value:t.isSearchPopShow,callback:function(e){t.isSearchPopShow=e},expression:"isSearchPopShow"}},[i("el-input",{attrs:{slot:"reference",placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"mini"},on:{input:t.inputSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit.apply(null,arguments)}},slot:"reference",model:{value:t.searchInput,callback:function(e){t.searchInput=e},expression:"searchInput"}}),t.searchSuggestList.songs?t._e():i("div",{staticClass:"hotSearch"},[i("div",{staticClass:"hotSearchTitle"},[t._v("热搜榜")]),t._l(t.hotSearchList,(function(e,s){return i("div",{key:s,staticClass:"hotSearchItem",on:{click:function(s){return t.clickHotSearchItem(e.searchWord)}}},[i("div",{staticClass:"hotSearchIndex",class:s<3?"topThree":""},[t._v(" "+t._s(s+1)+" ")]),i("div",{staticClass:"hotSearchInfo"},[i("div",{staticClass:"hotSearchWord",class:s<3?"hotSearchWordTopThree":""},[t._v(" "+t._s(e.searchWord)+" ")]),i("div",{staticClass:"hotSearchContent"},[t._v(t._s(e.content))])])])}))],2),i("div",{staticClass:"searchSuggest"},[t.searchSuggestList.songs?i("div",{staticClass:"hotSearchTitle"},[t._v("搜索建议")]):t._e(),t.searchSuggestList.songs&&0!=t.searchSuggestList.songs.length?i("div",{staticClass:"searchSuggestItem"},[i("div",{staticClass:"searchSuggestItemTitle"},[i("i",{staticClass:"iconfont icon-yinle"}),t._v(" 单曲")]),t._l(t.searchSuggestList.songs,(function(e,s){return i("div",{key:s,staticClass:"suggestItemDetail",on:{click:function(s){return t.clickSuggestSong(e.id)}}},[t._v(" "+t._s(e.name+" - "+e.artists[0].name)+" ")])}))],2):t._e(),t.searchSuggestList.artists&&0!=t.searchSuggestList.artists.length?i("div",{staticClass:"searchSuggestItem"},[i("div",{staticClass:"searchSuggestItemTitle"},[i("i",{staticClass:"iconfont icon-mic"}),t._v(" 歌手")]),t._l(t.searchSuggestList.artists,(function(e,s){return i("div",{key:s,staticClass:"suggestItemDetail",on:{click:function(s){return t.clickSuggestSinger(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2):t._e(),t.searchSuggestList.playlists&&0!=t.searchSuggestList.playlists.length?i("div",{staticClass:"searchSuggestItem"},[i("div",{staticClass:"searchSuggestItemTitle"},[i("i",{staticClass:"iconfont icon-gedan"}),t._v(" 歌单")]),t._l(t.searchSuggestList.playlists,(function(e,s){return i("div",{key:s,staticClass:"suggestItemDetail",on:{click:function(s){return t.clickSuggestMusicList(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2):t._e()])],1)],1)]),i("div",{staticClass:"login"},[t.isLogin?i("div",{staticClass:"userinfo"},[i("div",{staticClass:"userinfo-img"},[i("img",{staticClass:"auto-img",attrs:{src:t.userInfo.avatarUrl,alt:""},on:{click:t.goToPersonal}})]),i("div",{staticClass:"userinfo-name"},[t._v(t._s(t.userInfo.nickname))])]):i("el-popover",{attrs:{placement:"left-start",width:"300",trigger:"click","popper-class":"my-popover"}},[i("div",{staticClass:"CheckUser"},[i("h2",{staticClass:"CheckUserH2"},[t._v("密码登陆")]),i("el-input",{attrs:{type:"number",placeholder:"请输入手机号"},model:{value:t.loginPhone,callback:function(e){t.loginPhone=e},expression:"loginPhone"}}),i("el-input",{attrs:{placeholder:"请输入密码","show-password":""},model:{value:t.loginPsw,callback:function(e){t.loginPsw=e},expression:"loginPsw"}}),i("div",{staticClass:"subLogin",staticStyle:{width:"70px",margin:"0px auto","margin-top":"10px"}},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.Login}},[t._v("登陆")])],1),i("el-popover",{attrs:{placement:"bottom",title:"二维码登陆",width:"200",trigger:"click"}},[i("div",{staticClass:"qrimg"},[i("img",{attrs:{src:t.qrimg,alt:""}})]),i("el-button",{staticClass:"erweima",attrs:{slot:"reference"},on:{click:t.erweima},slot:"reference"},[i("img",{staticClass:"auto-img erw",attrs:{src:s("7e9b"),alt:""}})])],1)],1),i("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("登陆")])],1)],1)])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"headerBar-left"},[i("img",{attrs:{src:s("4ffd"),alt:""}})])}],r=s("d930"),o=s("2f62");let l;var u={name:"HeaderBar",data(){return{loginPhone:"",loginPsw:"",userInfo:null,isPopoverShow:!1,isSearchPopShow:!1,hotSearchList:[],searchInput:"",searchSuggestList:{},isRegisteredShow:!1,unikey:"",qrimg:"",time:null}},created(){this.getHotSearch(),window.localStorage.getItem("userId")&&this.getInfo()},computed:{...Object(o["c"])(["isLogin","musicListId"])},methods:{...Object(o["b"])(["updataLoginState","changePlayState","updateMusicId","updateMusicList"]),clickHotSearchItem(t){this.searchInput=t,this.goSearch()},clickSuggestSinger(t){this.$router.push({name:"singerDetail",params:{id:t}}),this.isSearchPopShow=!1},clickSuggestMusicList(t){this.$router.push({name:"musicListDetail",params:{id:t}}),this.isSearchPopShow=!1},async getMusicInfo(t){const e=await this.get("/song/detail",{ids:t});return e.songs[0].dt=Object(r["b"])(e.songs[0].dt),e.songs[0]},async clickSuggestSong(t){const e=await this.getMusicInfo(t);this.isSearchPopShow=!1;const{musicList:s}=this.$store.state,{currentIndex:i}=this.$store.state,a=s.find(t=>t.id===e.id);a?this.updateMusicId(e.id):(this.changePlayState(!1),s.splice(i+1,0,e),this.updateMusicId(e.id),this.updateMusicList({musicList:s,musicListId:this.musicListId}))},async getSearchSuggest(t){const e=await this.get("/search/suggest",{keywords:t});this.searchSuggestList=e.result},inputSearch(t){clearTimeout(l),""!==t?l=setTimeout(()=>{this.getSearchSuggest(t)},500):this.searchSuggestList={}},onSubmit(t){13===t.keyCode&&""!==this.searchInput&&this.goSearch()},async getHotSearch(){const t=await this.get("/search/hot/detail");this.hotSearchList=t.data},goSearch(){this.isSearchPopShow=!1,this.$router.push({name:"search",params:{id:this.searchInput}})},clickHotSearchItem(t){this.searchInput=t,this.goSearch()},async Login(){const t=Date.parse(new Date),e=await this.get("login/cellphone",{phone:this.loginPhone,password:this.loginPsw,timestamp:t});if(200!==e.code)return this.$message.error(e.msg),this.loginPhone="",void(this.loginPsw="");this.$message.success(e.msg),window.localStorage.setItem("userId",e.account.id),this.$message.success("登录成功!"),this.updataLoginState(!0),this.loginPhone="",this.loginPsw="",this.getInfo()},erweima(){this.QRCodeLogin()},async QRCodeLogin(){const t=Date.parse(new Date),e=await this.get("/login/qr/key",{timestamp:t});this.unikey=e.data.unikey,this.QRCodeKey(this.unikey),this.time=setInterval(()=>{this.QRCodeStote(this.unikey)},5e3)},async QRCodeKey(t){const e=Date.parse(new Date),s=await this.get("/login/qr/create",{key:t,qrimg:!0,timestamp:e});this.qrimg=s.data.qrimg},async QRCodeStote(t){const e=Date.parse(new Date),s=await this.get("/login/qr/check",{key:t,timestamp:e},!1);803===s.code&&(this.$message.success("登录成功!"),this.getuser(),clearInterval(this.time))},async getuser(){const t=await this.get("/user/account");this.userInfo=t.profile,window.localStorage.setItem("userId",t.account.id),this.updataLoginState(!0)},async getInfo(){const t=Date.parse(new Date),e=await this.get("/user/detail",{uid:window.localStorage.getItem("userId"),timestamp:t});e.profile&&(this.userInfo=e.profile,this.updataLoginState(!0))},goToPersonal(){this.$route.path!=="/Personal/"+this.userInfo.userId&&this.$router.push({name:"personal",params:{uid:this.userInfo.userId}})}},watch:{isLogin(t){t||(this.userInfo={}),this.getInfo()}}},d=u,h=(s("a60e"),s("2877")),m=Object(h["a"])(d,c,n,!1,null,"62509790",null),g=m.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bottomControl"},[i("audio",{ref:"audioPlayer",attrs:{src:t.musicUrl,autoplay:""},on:{play:function(e){return t.changeState(!0)},pause:function(e){return t.changeState(!1)},ended:function(e){return t.changeMusic("next")},timeupdate:t.timeupdate}}),i("div",{staticClass:"left"},[i("div",{staticClass:"avatar",on:{click:function(e){return t.$store.commit("changeMusicDetailCardState")}}},[t.musicDetail.al?i("img",{attrs:{src:t.musicDetail.al.picUrl,alt:"",draggable:!1}}):i("img",{attrs:{src:s("5f35"),alt:"",draggable:!1}})]),i("div",{staticClass:"musicInfo"},[t.musicDetail&&t.musicDetail.name?i("div",{staticClass:"musicName"},[t._v(" "+t._s(t.musicDetail.name)+" ")]):t._e(),t.musicDetail&&t.musicDetail.name?i("div",{staticClass:"singer"},[t._v(" "+t._s(t.musicDetail.ar[0].name)+" ")]):t._e()])]),i("div",{staticClass:"center"},[i("div",{staticClass:"buttons"},[i("span",{on:{click:function(e){t.playType="order"==t.playType?"random":"order"}}},["order"==t.playType?i("i",{staticClass:"iconfont icon-xunhuan"}):i("i",{staticClass:"iconfont icon-suiji1"})]),i("span",{on:{click:function(e){0!=t.musicList.length&&t.changeMusic("pre")}}},[i("i",{staticClass:"iconfont icon-shangyishou"})]),i("span",{on:{click:function(e){0!=t.musicList.length&&t.changePlay()}}},[t.isPlay?i("i",{staticClass:"iconfont icon-zantingtingzhi"}):i("i",{staticClass:"iconfont icon-icon_play"})]),i("span",{on:{click:function(e){0!=t.musicList.length&&t.changeMusic("next")}}},[i("i",{staticClass:"iconfont icon-xiayishou"})]),i("span",[i("i",{staticClass:"iconfont icon-xihuan",class:t.isUserLikeCurrentMusic?"like":"",on:{click:function(e){0!=t.musicList.length&&t.likeIt()}}})])]),i("div",{staticClass:"progressBar"},[i("span",{staticClass:"currentTime"},[t._v(t._s(t._f("handleMusicTime")(t.currentTime)))]),i("el-slider",{staticClass:"progressSlider",attrs:{"show-tooltip":!1,disabled:0==t.musicList.length},on:{change:t.changeProgress},model:{value:t.timeProgress,callback:function(e){t.timeProgress=e},expression:"timeProgress"}}),i("span",{staticClass:"totalTime"},[t._v(t._s(t.duration))])],1)]),i("div",{staticClass:"right"},[i("div",{staticClass:"volumeControl"},[i("i",{staticClass:"iconfont icon-yinliang",on:{click:t.changeMutedState}}),i("el-slider",{staticClass:"volumeSlider",attrs:{"show-tooltip":!1},on:{input:t.changeVolume},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),i("div",{staticClass:"playList",on:{click:t.openDrawer}},[i("i",{staticClass:"iconfont icon-bofangliebiao"})])]),i("el-drawer",{attrs:{visible:t.drawer,"with-header":!1,width:"300"},on:{"update:visible":function(e){t.drawer=e}}},[i("div",{staticClass:"drawerHeader"},[t._v("总"+t._s(t.musicList.length)+"首")]),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.musicList,stripe:"","show-header":!1,"highlight-current-row":"",lazy:""},on:{"row-dblclick":t.clickRow}},[i("el-table-column",{attrs:{prop:"name",width:"150px"}}),i("el-table-column",{attrs:{prop:"ar[0].name",width:"80px"}}),i("el-table-column",{attrs:{prop:"dt",width:"70px"}})],1)],1)],1)},f=[];let C=0,v=0,y=0;var I={name:"BottomControl",data(){return{musicDetail:{},musicUrl:"",currentMusicIndex:0,drawer:!1,duration:"00:00",timeProgress:0,volume:30,isMuted:!1,hasDrawerOpend:!1,likeMuiscList:[],isUserLikeCurrentMusic:!1,playType:"order"}},computed:{...Object(o["c"])(["isPlay","musicList","musicId","currentIndex","isLogin","currentTime"])},methods:{...Object(o["b"])(["updateMusicLoadState","updataLikeMuiscList","changePlayState","updateCurrentIndex","updateMusicId","updateCurrentTime"]),async getMusicDetail(t){this.updateMusicLoadState(!0);const e=await this.get("/song/url",{id:t});if(null===e.data[0].url)return this.$message.error("该歌曲暂无版权，将为您播放下一首歌曲"),void this.changeMusic("next");this.musicUrl=e.data[0].url,this.updateMusicLoadState(!1)},async likeMusic(t,e){await this.get("/like",{id:t,like:e})},async getLikeMusicList(){const t=Date.parse(new Date),e=await this.get("/likelist",{uid:window.localStorage.getItem("userId"),timestamp:t});this.likeMuiscList=e.ids,this.updataLikeMuiscList(this.likeMuiscList)},changePlay(){this.isPlay?this.pauseMusic():this.playMusic()},playMusic(){this.$refs.audioPlayer.play()},pauseMusic(){this.$refs.audioPlayer.pause()},changeState(t){this.changePlayState(t)},getMusicDetailFromMusicList(){this.musicList.forEach((t,e)=>{t.id===this.musicId&&(this.currentMusicIndex=e,this.updateCurrentIndex(e),this.musicDetail=t,this.duration=this.musicList[e].dt)});const t=this.musicList.findIndex(t=>t.id===this.musicId);-1!==t&&(this.currentMusicIndex=t,this.updateCurrentIndex(t),this.musicDetail=this.musicList[t],this.duration=this.musicList[t].dt)},changeMusic(t,e){if("click"===t)this.updateMusicId(e);else if("pre"===t){const{currentMusicIndex:t}=this;let e;if("order"===this.playType)e=t-1<0?this.musicList.length-1:t-1;else if("random"===this.playType)if(1===this.musicList.length)e=t;else{e=t;while(e===t)e=Math.floor(Math.random()*this.musicList.length)}this.updateMusicId(this.musicList[e].id)}else if("next"===t){const{currentMusicIndex:t}=this;let e;if("order"===this.playType)e=t+1===this.musicList.length?0:t+1;else if("random"===this.playType)if(1===this.musicList.length)e=t;else{e=t;while(e===t)e=Math.floor(Math.random()*this.musicList.length)}this.updateMusicId(this.musicList[e].id)}},clickRow(t){this.changeMusic("click",t.id)},timeupdate(){let t=this.$refs.audioPlayer.currentTime;this.updateCurrentTime(t),t=Math.floor(t),t!==C&&(C=t,this.timeProgress=Math.floor(t/v*100))},changeProgress(t){const e=Math.floor(t/100*v);this.updateCurrentTime(e),this.$refs.audioPlayer.currentTime=this.currentTime},changeVolume(t){this.$refs.audioPlayer.volume=t/100,this.isMuted&&t>0?this.isMuted=!1:0===t&&!1===this.isMuted&&(this.isMuted=!0)},changeMutedState(){this.isMuted?this.volume=y:(y=this.volume,this.volume=0),this.isMuted=!this.isMuted},handleDrawerListDOM(t,e){this.$nextTick(()=>{const s=document.querySelector(".bottomControl").querySelectorAll(".el-table__row");s[t]&&(s[t].children[0].querySelector(".cell").classList.add("currentRow"),s[t].children[1].querySelector(".cell").classList.add("currentRow")),(e&&-1!==e&&s[e]||0===e)&&(s[e].children[0].querySelector(".cell").classList.remove("currentRow"),s[e].children[1].querySelector(".cell").classList.remove("currentRow"))})},openDrawer(){this.drawer=!this.drawer,this.hasDrawerOpend=!0,this.handleDrawerListDOM(this.currentMusicIndex)},getIsUserLikeCurrentMusic(){this.isUserLikeCurrentMusic=this.likeMuiscList.find(t=>t===this.musicId)},async likeIt(){window.localStorage.getItem("userId")?(this.isUserLikeCurrentMusic=!this.isUserLikeCurrentMusic,await this.likeMusic(this.musicId,this.isUserLikeCurrentMusic),await this.getLikeMusicList()):this.$message.error("请先登录!")}},watch:{currentTime(t,e){e&&Math.abs(t-e)>=1&&(this.$refs.audioPlayer.currentTime=t)},musicId(t){this.pauseMusic(),this.getMusicDetailFromMusicList(),this.getMusicDetail(t),v=Object(r["d"])(this.duration),this.getIsUserLikeCurrentMusic()},currentIndex(t,e){this.hasDrawerOpend&&this.handleDrawerListDOM(t,e)},isPlay(t){t?this.playMusic():this.pauseMusic()},isLogin(t){t?this.getLikeMusicList():this.likeMuiscList=[]}},filters:{handleMusicTime:r["b"]}},w=I,S=(s("93fd"),Object(h["a"])(w,p,f,!1,null,"c781db52",null)),k=S.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"musicDetailCard",class:[t.isMusicDetailCardShow?"":"hide",t.backgroundMode?"":"glassCard"]},[i("div",{staticClass:"closeCard",on:{click:t.closeCard}},[i("i",{staticClass:"iconfont icon-arrow-down-bold"})]),i("div",{staticClass:"changeBackground",on:{click:t.changeBackground}},[i("i",{staticClass:"iconfont icon-UniSetBackgroundTextStyle"})]),!t.cleanCard&&t.musicInfo.name?i("div",{staticClass:"musicDetailCardContainer"},[i("div",{staticClass:"top"},[i("div",{staticClass:"left"},[i("div",{staticClass:"discContainer"},[i("div",{ref:"needle",staticClass:"needle",class:t.isPlay?"needleRotate":""},[i("img",{attrs:{src:s("baf1"),alt:""}})]),i("div",{ref:"disc",staticClass:"disc",class:[t.isPlay?"":"pause",t.isMusicLoad?"":"discAnimation"]},[i("img",{attrs:{src:s("1fa1"),alt:""}}),t.musicInfo.al?i("img",{staticClass:"musicAvatar",attrs:{src:t.musicInfo.al.picUrl,alt:""}}):i("img",{staticClass:"musicAvatar",attrs:{src:s("5f35"),alt:""}})])])]),i("div",{staticClass:"right"},[i("div",{staticClass:"title"},[i("div",{staticClass:"musicName"},[t._v(t._s(t.musicInfo.name))]),i("div",{staticClass:"album",on:{click:function(e){return t.goToDetailPage("album",t.musicInfo.al.id)}}},[t._v(" "+t._s(t.musicInfo.al.name)+" ")]),i("div",{staticClass:"singer",on:{click:function(e){return t.goToDetailPage("singerDetail",t.musicInfo.ar[0].id)}}},[t._v(" "+t._s(t.musicInfo.ar[0].name)+" ")])]),i("lyrics-scroll",{attrs:{lyric:t.lyric}})],1)]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isCommentLoading,expression:"isCommentLoading"}],staticClass:"bottom",attrs:{"element-loading-background":"rgba(255, 255, 255, 0.1)"}},[i("comment",{staticClass:"commentComponent",attrs:{comments:t.comment.comments,commentId:t.musicId+"",musicTitle:t.musicInfo.name,commentType:"music"},on:{getComment:function(e){return t.getMusicComment(t.musicId)}}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v("最新评论("+t._s(t.comment.total)+")")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.comment.comments&&t.comment.comments[0],expression:"comment.comments && comment.comments[0]"}],staticClass:"page"},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.comment.total,small:"","page-size":20,"current-page":t.currentCommentPage},on:{"current-change":t.commentPageChange}})],1)],1)]):i("div",{staticClass:"tip"},[t._v("暂无播放音乐")])])},M=[],b=s("612c"),_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lyrics"},[s("div",{staticClass:"placeholder"}),t._l(t.lyric,(function(e,i){return s("div",{key:i,staticClass:"lyricsItem",class:t.lyricsIndex-1==i?"currentLyric":"",on:{click:function(s){return t.clickly(e)}}},[t._v(" "+t._s(e[1])+" ")])})),s("div",{staticClass:"placeholder"})],2)},x=[];let D=0;var P={name:"LyricsScroll",props:{lyric:{type:Array,default:[]}},data(){return{lyricsIndex:0}},computed:{...Object(o["c"])(["currentTime","musicId"])},methods:{...Object(o["b"])(["updateCurrentTime"]),clickly(t){this.updateCurrentTime(t[0])},lyricScroll(t){const e=document.querySelectorAll(".lyricsItem"),s=document.querySelector(".lyrics");if(0===D&&(D=e[0].offsetTop-s.offsetTop),e[t-1]){const i=e[t-1].offsetTop-s.offsetTop;s.scrollTo({behavior:"smooth",top:i-D})}},getCurrentLyricsIndex(t){let e=0;this.lyric.some(s=>{if(e<this.lyric.length-1)return t>s[0]&&(e+=1),t<=s[0]}),this.lyricsIndex=e}},watch:{currentTime(t,e){(e&&Math.abs(t-e)>=1||0===this.lyricsIndex&&this.lyric.length>1)&&this.lyric.length>1&&(this.getCurrentLyricsIndex(t),this.lyricScroll(this.lyricsIndex)),this.lyricsIndex<this.lyric.length&&t>=this.lyric[this.lyricsIndex][0]&&(this.lyricsIndex+=1,this.lyricScroll(this.lyricsIndex))},musicId(t){this.lyricsIndex=0},lyric(t){this.currentTime>1&&this.lyric.length>1&&(this.getCurrentLyricsIndex(this.currentTime),this.$nextTick(()=>{this.lyricScroll(this.lyricsIndex)}))}},created(){},mounted(){}},T=P,$=(s("914c"),Object(h["a"])(T,_,x,!1,null,"ca6aee1c",null)),O=$.exports;let j;var U={components:{LyricsScroll:O,Comment:b["a"]},name:"MusicDetailCard",data(){return{lyric:[[0,"正在加载歌词"]],currentCommentPage:1,comment:{},musicInfo:{},cleanCard:!0,backgroundMode:!0,isCommentLoading:!1,hotComments:[]}},watch:{isMusicDetailCardShow(t){clearTimeout(j),this.cleanCard=!1,t&&!this.comment.comments&&""!==this.musicId?(this.getLyric(this.musicId),this.getMusicComment(this.musicId)):!1===t&&(j=setTimeout(()=>{this.cleanCard=!0},3e3))},musicId(t){this.lyric=[[0,"正在加载歌词"]],this.currentCommentPage=1,this.musicInfo=this.musicList[this.currentIndex],this.comment={},this.isMusicDetailCardShow&&(this.getLyric(t),this.getMusicComment(t))}},computed:{...Object(o["c"])(["isPlay","isMusicLoad","musicId","isMusicDetailCardShow","currentIndex","musicList"])},methods:{...Object(o["b"])(["changeMusicDetailCardState"]),async getLyric(t){const e=await this.get("/lyric",{id:t}),s=e.lrc.lyric;let i=s.split("\n");const a=[];let c="",n="";const r=[];i.forEach(t=>{""!==t&&a.push(t)}),i=a,i.forEach(t=>{c=t.split("]")[0],n=t.split("]")[1];const e=c.slice(1).split(":");r.push([60*parseInt(e[0],10)+parseFloat(e[1]),n])}),this.lyric=r},async getMusicComment(t,e){const s=Date.parse(new Date);if(this.isCommentLoading=!0,"changePage"===e){const t=document.querySelector(".musicDetailCardContainer"),e=document.querySelector(".top");t.scrollTo({behavior:"smooth",top:e.clientHeight})}const i=await this.get("/comment/music",{id:t,offset:20*(this.currentCommentPage-1),timestamp:s});200!==i.code&&this.$message.error("获取评论失败,请稍后重试!"),this.isCommentLoading=!1,this.comment=i},commentPageChange(t){this.currentCommentPage=t,this.getMusicComment(this.$store.state.musicId,"changePage")},closeCard(){this.$store.commit("changeMusicDetailCardState")},changeBackground(){this.backgroundMode=!this.backgroundMode},goToDetailPage(t,e){this.$router.push({name:t,params:{id:e}}),this.changeMusicDetailCardState(!1)}}},R=U,q=(s("9f74"),Object(h["a"])(R,L,M,!1,null,"df6c359a",null)),E=q.exports,B={name:"Index",components:{HeaderBar:g,BottomControl:k,MusicDetailCard:E},data(){return{defaultActive:"",elmenuitemData:[{router:"/discover",class:"iconfont icon-yinle",title:"发现音乐"},{router:"/video",class:"iconfont icon-shipin",title:"视频"},{router:"/favorites",class:"iconfont icon-more",title:"收藏"},{router:"/recommendmusic",class:"iconfont icon-good",title:"每日推荐"}]}},computed:{...Object(o["c"])(["collectMusicList","isLogin","createdMusicList"])},methods:{...Object(o["b"])(["updateCollectMusicList","updateCreatedMusicList"]),async getUserMusicList(){const t=Date.parse(new Date),e=await this.get("/user/playlist",{uid:window.localStorage.getItem("userId"),timestamp:t}),{playlist:s=[]}=e,i=s.findIndex(t=>!0===t.subscribed);this.updateCollectMusicList(s.slice(i)),this.updateCreatedMusicList(s.slice(0,i)),this.createdMusicList[0].name="我喜欢的音乐"}},watch:{"$route.path"(t){-1===t.search("/musiclistdetail")?this.defaultActive="/"+t.split("/")[1]:this.defaultActive=t},isLogin(t){t?this.getUserMusicList():(this.updateCreatedMusicList([]),this.updateCollectMusicList([]))}}},H=B,A=(s("c7bd"),Object(h["a"])(H,i,a,!1,null,"65dd348f",null));e["default"]=A.exports},d74b:function(t,e,s){},d930:function(t,e,s){"use strict";function i(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(""+t.getFullYear()).substr(4-RegExp.$1.length)));const s={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(const i in s)if(new RegExp(`(${i})`).test(e)){const t=""+s[i];e=e.replace(RegExp.$1,1===RegExp.$1.length?t:a(t))}return e}function a(t){return("00"+t).substr(t.length)}function c(t){return t>1e4?(t=(t/1e4).toFixed(1),t+"万"):t}function n(t){t=parseInt(t),t=t>1e4?Math.floor(t/1e3):Math.floor(t);let e=Math.floor(t/60),s=Math.floor(t%60);return e=e<10?"0"+e:e,s=s<10?"0"+s:s,`${e}:${s}`}function r(t){t=t.split(":");const e=parseInt(t[0]),s=parseInt(t[1]);return 60*e+s}s.d(e,"a",(function(){return i})),s.d(e,"c",(function(){return c})),s.d(e,"b",(function(){return n})),s.d(e,"d",(function(){return r}))},e6ad:function(t,e,s){}}]);
//# sourceMappingURL=chunk-d3daef7c.f03128e9.js.map